{"outputs": [{"text": "vectorizer = TfidfVectorizer()\n    X = vectorizer.fit_transform(documents)\n    return pd.DataFrame(X.toarray(), columns=vectorizer.get_feature_names())", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "X", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "X", ".", "to", "array", "()", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())", "<", "|", "end", "of", "text", "|", ">\""], "logprobs": [-1.1452572345733643, -0.0073685296811163425, -0.004460623487830162, -0.0011719746980816126, -5.602820692729438e-06, -3.9219088648678735e-05, -5.006777428206988e-06, -1.5616295058862306e-05, -6.079655122448457e-06, -0.4075210988521576, -0.016616636887192726, -0.023651495575904846, -2.6746106147766113, -0.022380398586392403, -0.020660430192947388, -1.5020257706055418e-05, -5.6980417866725475e-05, -0.0008618692518211901, -0.00047994061606004834, -0.0003175231395289302, -0.05243094637989998, -0.03033842332661152, -4.31528314948082e-05, -0.0012860370334237814, -0.025059454143047333, -0.07934154570102692, -0.8312182426452637, -0.020203281193971634, -0.00014840454969089478, -0.002929207868874073, -0.061188701540231705, -0.1550150215625763, -0.008641231805086136, -0.19176296889781952, -0.0032029063440859318, -0.013725190423429012, -0.008750309236347675, -0.27289536595344543, -0.032575998455286026, -0.016091477125883102, -5.304672595229931e-05, -2.6464111215318553e-05, -0.010451700538396835, -2.622600959512056e-06, -0.00021205084340181202, -4.768370445162873e-07, -0.0026203603483736515, -0.2484140694141388, -1.4692389965057373, -1.7881377516459906e-06, -1.0728830375228426e-06, -0.00010716341057559475, -0.00018094333063345402, -2.4081084728240967, -0.012533587403595448], "finish_reason": "stop"}], "metrics": {"energy": 124.0371543045044, "energy_per_token": 2.2552209873546256, "time": 3.1528835, "time_per_token": 0.057325154545454546}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer()\n    matrix = vectorizer.fit_transform(documents)\n    df = pd.DataFrame(data = matrix.toarray(),\n                      columns=vectorizer.get_feature_names())\n\n    return df", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "matrix", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "df", " =", " pd", ".", "DataFrame", "(", "data", " =", " matrix", ".", "to", "array", "()", ",", "\n", "                ", "      ", "columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())", "\n", "\n", "    ", "return", " df", "\n", "\n", "def"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -0.38277995586395264, -0.016175348311662674, -0.026147279888391495, -3.030578136444092, -0.029241371899843216, -0.018164828419685364, -2.5152843591058627e-05, -5.054346183896996e-05, -0.0006225554971024394, -0.0008083889842964709, -0.0001677133986959234, -0.03540673851966858, -0.020516207441687584, -4.076874756719917e-05, -0.0012346034636721015, -0.06362486630678177, -0.08636833727359772, -1.5810060501098633, -0.06895334273576736, -0.023891182616353035, -0.0033462028950452805, -0.006977477576583624, -0.026332493871450424, -2.740849494934082, -2.7308411598205566, -0.1224534884095192, -0.02708403207361698, -0.23735389113426208, -0.007266283966600895, -0.028894105926156044, -0.017980320379137993, -2.456179618835449, -0.11195620149374008, -0.3597007393836975, -0.4789156913757324, -1.5563361644744873, -0.0827629566192627, -2.52720492426306e-05, -4.768258077092469e-05, -0.014889420941472054, -7.390948667307384e-06, -0.00022623363474849612, -3.576278118089249e-07, -0.0015210260171443224, -0.4795166850090027, -0.02705850638449192, -2.209099769592285, -0.012472721748054028, -0.05627956613898277, -0.08137069642543793, -0.5877060890197754, -0.01864631101489067, -1.3364146947860718], "finish_reason": "stop"}], "metrics": {"energy": 58.94430320930481, "energy_per_token": 0.9507145678920131, "time": 2.5350206, "time_per_token": 0.04088742903225807}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer()\n    tfidf_matrix = vectorizer.fit_transform(documents)\n    words_df = pd.DataFrame(vectorizer.get_feature_names_out())\n    score_df = pd.DataFrame(tfidf_matrix.todense(), columns=words_df.columns, index=words_df.index)\n    return score_df\n\ndocs = ['This is the first document.', 'This document is the second document.', 'And this is the third one.', 'Is this the first document?']\ntfidf_df = task_func(docs)\nprint(tfidf_df.shape)", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "tf", "id", "f", "_", "matrix", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "words", "_", "df", " =", " pd", ".", "DataFrame", "(", "vector", "izer", ".", "get", "_", "feature", "_", "names", "_", "out", "())", "\n", "    ", "score", "_", "df", " =", " pd", ".", "DataFrame", "(", "tf", "id", "f", "_", "matrix", ".", "t", "od", "ense", "()", ",", " columns", "=", "words", "_", "df", ".", "columns", ",", " index", "=", "words", "_", "df", ".", "index", ")", "\n", "    ", "return", " score", "_", "df", "\n", "\n", "docs", " =", " ['", "This", " is", " the", " first", " document", ".", "'", ",", " '", "This", " document", " is", " the", " second", " document", ".", "'", ",", " '", "And", " this", " is", " the", " third", " one", ".", "'", ",", " '", "Is", " this", " the", " first", " document", "?", "']", "\n", "tf", "id", "f", "_", "df", " =", " task", "_", "func", "(", "docs", ")", "\n", "print", "(", "tf", "id", "f", "_", "df", ".", "shape", ")", "\n", "\n", "#"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -0.38277995586395264, -0.016175348311662674, -0.026147279888391495, -1.1316370964050293, -0.18103548884391785, -0.012627527117729187, -0.9017143249511719, -0.17874927818775177, -0.003420457011088729, -0.007071703672409058, -2.884823152271565e-05, -6.0437283536884934e-05, -0.00037067217635922134, -0.00041166413575410843, -8.880697714630514e-05, -0.014170265756547451, -0.022839931771159172, -4.160317621426657e-05, -0.0009507188224233687, -0.06488463282585144, -0.13554641604423523, -2.5572266578674316, -2.5026423931121826, -0.7586565613746643, -0.006465588230639696, -0.035366810858249664, -0.006852815393358469, -0.008197234943509102, -0.009205399081110954, -0.6962495446205139, -1.3708974620385561e-05, -2.8371408916427754e-05, -0.19840550422668457, -2.861018856492592e-06, -0.0003999863693024963, -7.152555099310121e-07, -0.0024405713193118572, -2.125415802001953, -0.00018630675913300365, -1.8589836359024048, -0.08651364594697952, -0.0747504010796547, -3.7548396587371826, -0.04247940331697464, -0.09385337680578232, -0.003030471969395876, -0.03072703815996647, -0.0019415830029174685, -0.006032947916537523, -0.008290755562484264, -0.011013551615178585, -1.645074735279195e-05, -1.9073468138230965e-06, -0.0002213471452705562, -7.354942499659956e-05, -0.002188669750466943, -2.2846574783325195, -9.524368942948058e-05, -0.010882551781833172, -0.3657945990562439, -0.01917773298919201, -0.6749821901321411, -0.07925114035606384, -0.03547588735818863, -0.000129691296024248, -9.524368942948058e-05, -0.04597998782992363, -0.23739789426326752, -0.8136761784553528, -0.0024227334652096033, -0.020230034366250038, -0.046544648706912994, -0.00017236177518498152, -3.099436753473128e-06, -0.0023913378827273846, -0.0027882291469722986, -0.006461205892264843, -0.021213075146079063, -0.09679358452558517, -0.09500692784786224, -0.012787840329110622, -5.602820692729438e-06, -8.34461570775602e-06, -0.5874067544937134, -0.023544497787952423, -2.085102081298828, -0.03336517512798309, -0.28503260016441345, -0.08462614566087723, -0.0036317838821560144, -0.01439061388373375, -0.001657304004766047, -0.0038732285611331463, -0.005643150769174099, -0.0032721806783229113, -0.00033849707688204944, -0.045751914381980896, -0.0038694285321980715, -0.003341331612318754, -0.00019834458362311125, -0.0002181292074965313, -0.00015639036428183317, -0.0017528659664094448, -0.0008081507403403521, -0.0003034608089365065, -0.00019536493346095085, -0.009809738956391811, -0.0014190138317644596, -0.0003812778159044683, -0.00014983485743869096, -0.00013076403411105275, -0.00016211149340961128, -0.00024780540843494236, -0.0013094907626509666, -0.0013366345083341002, -0.00011443436960689723, -0.00760682625696063, -0.0017764277290552855, -0.00015424491721205413, -0.0001932195882545784, -5.23315102327615e-05, -0.00027414379292167723, -0.0008407871937379241, -0.008187303319573402, -0.00454618688672781, -0.45647090673446655, -0.011538438498973846, -0.0007585985003970563, -2.2907052040100098, -1.2677104473114014, -0.0034221201203763485, -0.004537761677056551, -2.682172998902388e-05, -3.6000557884108275e-05, -0.0008802115335129201, -0.0007039214833639562, -0.021184131503105164, -0.05424103885889053, -0.20095612108707428, -0.00943546462804079, -0.018499691039323807, -2.622600959512056e-06, -1.3828182090946939e-05, -0.0001958416833076626, -7.283422019099817e-05, -0.3204372227191925, -0.12933121621608734, -0.24102172255516052, -0.42445817589759827, -0.5863766074180603, -0.5952521562576294], "finish_reason": "stop"}], "metrics": {"energy": 197.22609051895142, "energy_per_token": 1.2326630657434463, "time": 6.9342833, "time_per_token": 0.043339270624999995}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer()\n    tfidf_matrix = vectorizer.fit_transform(documents)\n\n    # Convert to a pandas DataFrame\n    df = pd.DataFrame(tfidf_matrix.toarray(), index=range(len(documents)), columns=vectorizer.get_feature_names())\n\n    return df", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "tf", "id", "f", "_", "matrix", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "\n", "    ", "#", " Convert", " to", " a", " pandas", " Data", "Frame", "\n", "    ", "df", " =", " pd", ".", "DataFrame", "(", "tf", "id", "f", "_", "matrix", ".", "to", "array", "()", ",", " index", "=", "range", "(", "len", "(", "doc", "uments", "))", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())", "\n", "\n", "    ", "return", " df", "\n", "\n", "def"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -0.38277995586395264, -0.016175348311662674, -0.026147279888391495, -1.1316370964050293, -0.18103548884391785, -0.012627527117729187, -0.9017143249511719, -0.17874927818775177, -0.003420457011088729, -0.007071703672409058, -2.884823152271565e-05, -6.0437283536884934e-05, -0.00037067217635922134, -0.00041166413575410843, -8.880697714630514e-05, -0.014170265756547451, -0.022839931771159172, -4.160317621426657e-05, -0.0009507188224233687, -0.06488463282585144, -2.066757917404175, -0.001632549217902124, -1.4759601354599, -0.9240432381629944, -2.878295421600342, -0.8008078336715698, -0.49870625138282776, -0.3073984682559967, -0.0035892606247216463, -0.21325230598449707, -0.0006436422117985785, -1.34911048412323, -0.04204664006829262, -0.013462472707033157, -0.005546300206333399, -0.0018726922571659088, -0.013312973082065582, -0.09562648832798004, -2.729855441430118e-05, -3.099436753473128e-06, -0.00039307496626861393, -0.00018952481332235038, -0.007994084618985653, -0.2313552051782608, -0.00482193473726511, -0.017297832295298576, -0.002687416272237897, -1.6901743412017822, -0.011081226170063019, -2.7568979263305664, -0.0001591317413840443, -0.6429023146629333, -0.00015317220822907984, -0.12313638627529144, -3.576272320060525e-06, -0.01696772314608097, -0.0003784178989008069, -0.023330001160502434, -0.059668246656656265, -0.011860683560371399, -8.106198947643861e-06, -2.109982233378105e-05, -0.008352585136890411, -3.576272320060525e-06, -0.00027426297310739756, -2.3841855067985307e-07, -0.0010683787986636162, -0.09019062668085098, -0.004581193905323744, -0.23585349321365356, -0.0003268184664193541, -0.07409629225730896, -0.02342328056693077, -0.5507720708847046, -0.01760241389274597, -1.5888688564300537], "finish_reason": "stop"}], "metrics": {"energy": 100.31143519401547, "energy_per_token": 1.1801345316942997, "time": 3.5915513, "time_per_token": 0.04225354470588235}}
{"outputs": [{"text": "#tokenizing and lowercase the documents\n    tokenized = [x.lower() for x in documents]\n    tokenized = [word_tokenize(x) for x in tokenized]\n    tfidf = TfidfVectorizer()\n    vectors = tfidf.fit_transform(tokenized)\n    return pd.DataFrame(vectors.toarray(), columns=tfidf.get_feature_names())", "tokens": ["#", "token", "izing", " and", " lower", "case", " the", " documents", "\n", "    ", "token", "ized", " =", " [", "x", ".", "lower", "()", " for", " x", " in", " documents", "]", "\n", "    ", "token", "ized", " =", " [", "word", "_", "token", "ize", "(", "x", ")", " for", " x", " in", " token", "ized", "]", "\n", "    ", "tf", "id", "f", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "vectors", " =", " tf", "id", "f", ".", "fit", "_", "transform", "(", "token", "ized", ")", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "vectors", ".", "to", "array", "()", ",", " columns", "=", "tf", "id", "f", ".", "get", "_", "feature", "_", "names", "())", "\n", "\n", "def"], "logprobs": [-1.8617913722991943, -4.568804740905762, -2.402172088623047, -3.2257957458496094, -3.4004878997802734, -2.475299596786499, -1.8796160221099854, -1.3010473251342773, -0.1444643884897232, -0.015072857029736042, -1.791677474975586, -0.09617539495229721, -2.1240100860595703, -0.29879942536354065, -3.581591844558716, -0.015316485427320004, -0.044260937720537186, -0.0008740180637687445, -0.07707928866147995, -0.025190236046910286, -0.000647692708298564, -0.3547353744506836, -0.014022869989275932, -0.0037064917851239443, -0.7619245052337646, -2.715472936630249, -0.08201424777507782, -0.3456665873527527, -0.20051783323287964, -0.3666903078556061, -0.005918833427131176, -0.0001234931987710297, -3.7788631743751466e-05, -0.005880910903215408, -0.262057900428772, -0.018389681354165077, -0.0036618339363485575, -0.0016749175265431404, -0.00033480284037068486, -0.023898165673017502, -2.729855441430118e-05, -0.0051985327154397964, -0.007731867954134941, -0.9810799360275269, -2.315802812576294, -0.20892339944839478, -0.007147812284529209, -0.2914723753929138, -0.019377104938030243, -5.722029527532868e-06, -0.004126961808651686, -7.152555099310121e-07, -3.3854863431770355e-05, -1.4662635294371285e-05, -0.23429840803146362, -0.3965212404727936, -0.07351075857877731, -3.616626739501953, -0.021995989605784416, -0.01444525271654129, -6.6756979322235566e-06, -2.3841855067985307e-07, -9.560128091834486e-05, -0.0018518695142120123, -0.005583287216722965, -0.00017426878912374377, -0.012160449288785458, -0.01083349622786045, -2.884823152271565e-05, -0.000929400441236794, -0.042193274945020676, -0.12933331727981567, -1.3542550802230835, -0.07110580801963806, -0.00010287232726113871, -0.002506212331354618, -0.06862382590770721, -0.029485395178198814, -0.005468054208904505, -0.26433345675468445, -0.010225880891084671, -0.02158331871032715, -0.008926722221076488, -0.5679662227630615, -0.10308270901441574, -0.012186946347355843, -0.0002307625545654446, -1.5616295058862306e-05, -5.4238757002167404e-05, -0.041481491178274155, -2.3007127310847864e-05, -0.0003120412293355912, -1.2159273865108844e-05, -0.005884466227144003, -0.17688581347465515, -0.8512774705886841, -0.05296461656689644, -1.706374168395996], "finish_reason": "stop"}], "metrics": {"energy": 123.3750088920593, "energy_per_token": 1.2589286621638704, "time": 4.214596, "time_per_token": 0.04300608163265306}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer()\n    X = vectorizer.fit_transform(documents)\n    return pd.DataFrame(X.toarray(), columns=vectorizer.get_feature_names())", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "X", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "X", ".", "to", "array", "()", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -0.38277995586395264, -0.016175348311662674, -0.026147279888391495, -2.45814847946167, -0.02004719153046608, -0.019378624856472015, -1.490105023549404e-05, -5.686121585313231e-05, -0.000673424918204546, -0.00040749352774582803, -0.0004233417857903987, -0.05563243106007576, -0.030300375074148178, -3.4927710657939315e-05, -0.001101244823075831, -0.02113627828657627, -0.06804922968149185, -0.83420330286026, -0.022247031331062317, -9.476689592702314e-05, -0.0034646503627300262, -0.060236118733882904, -0.1292225867509842, -0.007951746694743633, -0.1986859291791916, -0.003515256568789482, -0.014969868585467339, -0.010027745738625526, -0.2437342256307602, -0.031904906034469604, -0.015351821668446064, -5.6503606174374e-05, -2.7656173188006505e-05, -0.015065106563270092, -4.291525328881107e-06, -0.00024423000286333263, -4.768370445162873e-07, -0.002602406544610858, -0.22452008724212646], "finish_reason": "stop"}], "metrics": {"energy": 61.96642747879029, "energy_per_token": 1.2909672391414644, "time": 1.9077913, "time_per_token": 0.03974565208333333}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer()\n    X = vectorizer.fit_transform(documents)\n    return pd.DataFrame(X.todense(), columns=vectorizer.get_feature_names())", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "X", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "X", ".", "t", "od", "ense", "()", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())", "<", "|", "end", "of", "text", "|>"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -0.38277995586395264, -0.016175348311662674, -0.026147279888391495, -2.45814847946167, -0.02004719153046608, -0.019378624856472015, -1.490105023549404e-05, -5.686121585313231e-05, -0.000673424918204546, -0.00040749352774582803, -0.0004233417857903987, -0.05563243106007576, -0.030300375074148178, -3.4927710657939315e-05, -0.001101244823075831, -0.02113627828657627, -0.06804922968149185, -0.83420330286026, -0.022247031331062317, -9.476689592702314e-05, -0.0034646503627300262, -0.060236118733882904, -0.1292225867509842, -0.007951746694743633, -1.9080555438995361, -6.246371776796877e-05, -0.01490821223706007, -0.013757172971963882, -0.008935937657952309, -0.2653435170650482, -0.03242182731628418, -0.01453631091862917, -5.435795901576057e-05, -2.396077979938127e-05, -0.007725006900727749, -4.529942543740617e-06, -0.00027056847466155887, -3.576278118089249e-07, -0.002032121177762747, -0.19341661036014557, -1.502589225769043, -1.4305104514278355e-06, -1.1920922133867862e-06, -0.00012742661056108773, -0.00020692592079285532, -0.07969451695680618], "finish_reason": "stop"}], "metrics": {"energy": 50.27676320457458, "energy_per_token": 0.9141229673559014, "time": 2.1197, "time_per_token": 0.03854}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer()\n    tfidf_matrix = vectorizer.fit_transform(documents)\n    return pd.DataFrame(tfidf_matrix.toarray(), columns=vectorizer.get_feature_names_out(), index=range(len(documents)))", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "tf", "id", "f", "_", "matrix", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "tf", "id", "f", "_", "matrix", ".", "to", "array", "()", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "_", "out", "()", ",", " index", "=", "range", "(", "len", "(", "doc", "uments", ")))", "\n", "\n", "if"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -0.38277995586395264, -0.016175348311662674, -0.026147279888391495, -1.1316370964050293, -0.18103548884391785, -0.012627527117729187, -0.9017143249511719, -0.17874927818775177, -0.003420457011088729, -0.007071703672409058, -2.884823152271565e-05, -6.0437283536884934e-05, -0.00037067217635922134, -0.00041166413575410843, -8.880697714630514e-05, -0.014170265756547451, -0.022839931771159172, -4.160317621426657e-05, -0.0009507188224233687, -0.06488463282585144, -0.13554641604423523, -1.2469488382339478, -0.026011859998106956, -0.00012706902634818107, -0.0019056509481742978, -0.058594826608896255, -0.058171346783638, -4.482168878894299e-05, -1.1086402082582936e-05, -0.0002119316632160917, -0.0003064401389565319, -0.010955777019262314, -0.24359771609306335, -0.011953508481383324, -0.029799016192555428, -0.006901474203914404, -0.30491772294044495, -0.024996671825647354, -0.008584619499742985, -5.280832192511298e-05, -3.93382906622719e-05, -0.018877724185585976, -7.152531907195225e-06, -0.00025293012731708586, -3.576278118089249e-07, -0.0017983231227844954, -2.590240955352783, -0.00011514954530866817, -1.9708597660064697, -0.021152034401893616, -0.03863741084933281, -0.09510719776153564, -0.509964644908905, -0.0002411313180346042, -0.6147478818893433, -7.86750388215296e-05, -0.11012214422225952, -1.1324817933200393e-05, -0.013805967755615711, -0.37489670515060425, -0.02704678662121296, -1.12861967086792], "finish_reason": "stop"}], "metrics": {"energy": 89.35398397445681, "energy_per_token": 1.2585068165416453, "time": 2.949416, "time_per_token": 0.04154107042253521}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer()\n    X = vectorizer.fit_transform(documents)\n    df = pd.DataFrame(X.toarray(), columns=vectorizer.get_feature_names())\n    return df", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "X", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "df", " =", " pd", ".", "DataFrame", "(", "X", ".", "to", "array", "()", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())", "\n", "    ", "return", " df", "\n", "\n", "def"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -0.38277995586395264, -0.016175348311662674, -0.026147279888391495, -2.45814847946167, -0.02004719153046608, -0.019378624856472015, -1.490105023549404e-05, -5.686121585313231e-05, -0.000673424918204546, -0.00040749352774582803, -0.0004233417857903987, -0.05563243106007576, -0.030300375074148178, -3.4927710657939315e-05, -0.001101244823075831, -0.02113627828657627, -0.06804922968149185, -2.2895102500915527, -0.05705060437321663, -0.017263853922486305, -0.0039222706109285355, -0.0063722520135343075, -0.023643461987376213, -0.2896580994129181, -0.003950055688619614, -0.21280086040496826, -0.0025391501840204, -0.01729009859263897, -0.005833386909216642, -0.34740638732910156, -0.05238037928938866, -0.019714366644620895, -2.753696753643453e-05, -1.4066597032069694e-05, -0.006142547354102135, -4.172316494077677e-06, -0.00018094333063345402, -4.768370445162873e-07, -0.0018011790234595537, -0.16592749953269958, -0.01046172808855772, -0.0885501280426979, -0.047294117510318756, -0.04056843742728233, -0.5393482446670532, -0.01903434842824936, -1.224895715713501], "finish_reason": "stop"}], "metrics": {"energy": 73.39379476547242, "energy_per_token": 1.3106034779548648, "time": 2.5422533, "time_per_token": 0.04539738035714286}}
{"outputs": [{"text": "word_list = [word_tokenize(text) for text in documents]\n    vectorizer = TfidfVectorizer()\n    vectorized_docs = vectorizer.fit_transform(word_list)\n    return pd.DataFrame(vectorized_docs.toarray(), columns=vectorizer.get_feature_names_out())", "tokens": ["word", "_", "list", " =", " [", "word", "_", "token", "ize", "(", "text", ")", " for", " text", " in", " documents", "]", "\n", "    ", "vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "vector", "ized", "_", "docs", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "word", "_", "list", ")", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "vector", "ized", "_", "docs", ".", "to", "array", "()", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "_", "out", "())", "<", "|", "end", "of", "text", "|>"], "logprobs": [-3.881517171859741, -0.055586084723472595, -1.5660322904586792, -0.04982942342758179, -1.1789493560791016, -0.19771374762058258, -0.015363208949565887, -0.00022587609419133514, -2.396077979938127e-05, -0.006342994049191475, -2.2455875873565674, -0.1382397562265396, -0.0035537441726773977, -0.012938006781041622, -0.000192504478036426, -0.014904101379215717, -0.005371542181819677, -0.015877017751336098, -0.13150309026241302, -0.6262637376785278, -0.015109257772564888, -0.0026481819804757833, -0.0006118332967162132, -3.576272320060525e-06, -4.160317621426657e-05, -2.7418097943154862e-06, -1.5139465176616795e-05, -7.271740287251305e-06, -0.42099371552467346, -0.010186351835727692, -0.016718517988920212, -1.2888516187667847, -1.4230318069458008, -0.17837963998317719, -1.2712689638137817, -0.0032689727377146482, -0.0387386791408062, -2.4676019165781327e-05, -2.074220174108632e-05, -0.0026739814784377813, -0.0010549224680289626, -0.0001461399078834802, -0.007894031703472137, -0.06414465606212616, -3.290122185717337e-05, -4.255681051290594e-05, -0.0005221195751801133, -0.01954791322350502, -0.08157166838645935, -1.2208878993988037, -0.05460963770747185, -2.3007127310847864e-05, -0.0018892312655225396, -0.10805779695510864, -0.08092398941516876, -0.03477991372346878, -1.0490362910786644e-05, -6.0794889577664435e-05, -0.005260909907519817, -0.24082159996032715, -0.005054196808487177, -0.01976368948817253, -0.014491429552435875, -0.1915159374475479, -0.03593841567635536, -0.007642672397196293, -0.0032991524785757065, -4.768258077092469e-05, -0.02517896145582199, -6.9141146923357155e-06, -0.00028200942324474454, -3.576278118089249e-07, -0.000945240433793515, -2.532731294631958, -7.86750388215296e-05, -0.058385469019412994, -1.7258968353271484, -1.6689286894688848e-06, -1.1920922133867862e-06, -4.7801782784517854e-05, -0.00012242044613230973, -0.07451795041561127], "finish_reason": "stop"}], "metrics": {"energy": 110.01329624748226, "energy_per_token": 1.341625563993686, "time": 3.7977803, "time_per_token": 0.04631439390243902}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer()\n    tfidf = vectorizer.fit_transform(documents)\n    return pd.DataFrame(tfidf.toarray(), columns=vectorizer.get_feature_names())", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "tf", "id", "f", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "tf", "id", "f", ".", "to", "array", "()", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -0.38277995586395264, -0.016175348311662674, -0.026147279888391495, -1.1316370964050293, -0.18103548884391785, -0.012627527117729187, -0.53619384765625, -0.015010383911430836, -3.373566141817719e-05, -0.00010442188795423135, -0.0008560330606997013, -0.0025296376552432775, -0.00010859376925509423, -0.017646219581365585, -0.016360072419047356, -5.185469490243122e-05, -0.0011649496154859662, -0.05654164031147957, -0.12252172082662582, -0.9013760089874268, -0.03905239328742027, -0.00010251473577227443, -0.0018296183552592993, -0.06525725871324539, -0.08460412919521332, -4.434487345861271e-05, -1.0251946150674485e-05, -0.018195146694779396, -0.3142022490501404, -0.006088637746870518, -0.018215984106063843, -0.008141426369547844, -0.41201648116111755, -0.033657874912023544, -0.03313755244016647, -7.068861305015162e-05, -2.3364747903542593e-05, -0.04108605161309242, -5.006777428206988e-06, -0.0002348147245356813, -3.576278118089249e-07, -0.0019721598364412785, -0.2913956046104431], "finish_reason": "stop"}], "metrics": {"energy": 77.49337257385255, "energy_per_token": 1.49025716488178, "time": 2.328593, "time_per_token": 0.04478063461538462}}
{"outputs": [{"text": "tf_vectorizer = TfidfVectorizer()\n    tf_matrix = tf_vectorizer.fit_transform(documents)\n    return tf_matrix", "tokens": ["tf", "_", "vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "tf", "_", "matrix", " =", " tf", "_", "vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "return", " tf", "_", "matrix", "\n", "\n", "print"], "logprobs": [-1.799743413925171, -2.192121744155884, -1.6225016117095947, -0.02210490219295025, -0.0061628068797290325, -0.003238554112613201, -8.106198947643861e-06, -0.0008381668012589216, -2.861018856492592e-06, -9.464769391342998e-05, -0.00016544880054425448, -0.43503955006599426, -0.02459244802594185, -0.028602328151464462, -0.5753069519996643, -0.2502443492412567, -1.0302866697311401, -0.009709395468235016, -0.009774678386747837, -9.655486064730212e-05, -0.00019178935326635838, -1.3351351299206726e-05, -8.177422569133341e-05, -0.000392598332837224, -0.0009132028790190816, -0.00011896379146492109, -0.01504408661276102, -0.010437426157295704, -6.139089964563027e-05, -0.0009398810216225684, -0.03198064863681793, -0.1486533284187317, -1.0780366659164429, -1.831782579421997, -0.045919302850961685, -0.21160992980003357, -1.4367585182189941, -0.03259053826332092, -3.356809616088867], "finish_reason": "stop"}], "metrics": {"energy": 43.371530055999756, "energy_per_token": 1.112090514256404, "time": 1.4854662, "time_per_token": 0.03808887692307693}}
{"outputs": [{"text": "tokenizer = lambda x: word_tokenize(x)\n    vectorizer = TfidfVectorizer()\n    vector = vectorizer.fit_transform(documents)\n    return pd.DataFrame(vector.todense(), columns=vectorizer.get_feature_names())", "tokens": ["token", "izer", " =", " lambda", " x", ":", " word", "_", "token", "ize", "(", "x", ")", "\n", "    ", "vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "vector", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "vector", ".", "t", "od", "ense", "()", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())", "\n", "\n", "#"], "logprobs": [-3.818979024887085, -0.22519661486148834, -0.014470280148088932, -2.3551254272460938, -1.9093748331069946, -0.037738632410764694, -0.10568805783987045, -0.00011085849109804258, -2.5033637939486653e-05, -1.0371154530730564e-05, -0.0005865760613232851, -0.004569801967591047, -0.041847050189971924, -0.012410322204232216, -0.058327220380306244, -0.3581329584121704, -0.007024236489087343, -0.0024336741771548986, -0.002998501295223832, -3.3378546504536644e-06, -7.462222856702283e-05, -4.887569048150908e-06, -2.3603161025675945e-05, -9.179073458653875e-06, -2.5606117248535156, -0.010484614409506321, -0.12905265390872955, -1.3355859518051147, -1.6537740230560303, -0.012537943199276924, -7.426462980220094e-05, -0.0002076410164590925, -0.009678109548985958, -0.02360341139137745, -0.00015841660206206143, -0.11245531588792801, -0.14517541229724884, -9.679325739853084e-05, -0.002369336551055312, -0.0172598697245121, -0.07465182989835739, -1.0366451740264893, -0.04841538891196251, -0.00012694983161054552, -0.0023826563265174627, -0.06150386109948158, -0.10993131250143051, -0.4621160626411438, -1.068233609199524, -8.761498611420393e-05, -0.015073795802891254, -0.016759196296334267, -0.007588488981127739, -0.2956008315086365, -0.043610651046037674, -0.006853288970887661, -0.11587163805961609, -2.1576648578047752e-05, -0.01218588650226593, -4.768360213347478e-06, -0.00026854246971197426, -1.0728830375228426e-06, -0.001498172408901155, -0.21026824414730072, -0.5577923655509949, -0.031932733952999115, -1.8856512308120728], "finish_reason": "stop"}], "metrics": {"energy": 69.59368726062775, "energy_per_token": 1.0387117501586232, "time": 2.751694, "time_per_token": 0.04107005970149254}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer()\n    vector = vectorizer.fit_transform(documents)\n    df = pd.DataFrame(vector.toarray(), columns=vectorizer.get_feature_names())\n    return df", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "vector", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "df", " =", " pd", ".", "DataFrame", "(", "vector", ".", "to", "array", "()", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())", "\n", "    ", "return", " df", "\n", "\n", "if"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -0.38277995586395264, -0.016175348311662674, -0.026147279888391495, -1.6380553245544434, -1.6436271667480469, -0.003802452003583312, -0.00015066919149830937, -0.00013743886665906757, -0.0016883655916899443, -0.006742938421666622, -0.000169382052263245, -0.04227784276008606, -0.03299131244421005, -4.31528314948082e-05, -0.0013067525578662753, -0.015693847090005875, -0.09346791356801987, -2.2417731285095215, -0.06631797552108765, -0.028284506872296333, -0.00482134148478508, -0.005502080079168081, -0.02450358122587204, -0.09242388606071472, -0.2107030600309372, -0.3192701041698456, -0.003616936504840851, -0.019868873059749603, -0.008306597359478474, -0.37896883487701416, -0.06539137661457062, -0.0060850828886032104, -0.048485465347766876, -1.7762025890988298e-05, -0.007139171939343214, -5.602820692729438e-06, -0.00019834458362311125, -3.576278118089249e-07, -0.0015672078588977456, -0.13011159002780914, -0.012264079414308071, -0.10830718278884888, -0.04523443430662155, -0.037937551736831665, -0.5738303661346436, -0.015752404928207397, -1.140252947807312], "finish_reason": "stop"}], "metrics": {"energy": 68.85191341781615, "energy_per_token": 1.2294984538895741, "time": 2.5376387, "time_per_token": 0.045314976785714285}}
{"outputs": [{"text": "vec = TfidfVectorizer()\n    tfidf_matrix = vec.fit_transform(documents).toarray()\n    df = pd.DataFrame(tfidf_matrix, columns=vec.get_feature_names())\n    return df", "tokens": ["vec", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "tf", "id", "f", "_", "matrix", " =", " vec", ".", "fit", "_", "transform", "(", "doc", "uments", ")", ".", "to", "array", "()", "\n", "    ", "df", " =", " pd", ".", "DataFrame", "(", "tf", "id", "f", "_", "matrix", ",", " columns", "=", "vec", ".", "get", "_", "feature", "_", "names", "())", "\n", "    ", "return", " df"], "logprobs": [-3.52701735496521, -0.017376914620399475, -0.0014840076910331845, -9.059865078597795e-06, -9.762764238985255e-05, -5.483612312673358e-06, -3.707340147229843e-05, -5.125986263010418e-06, -0.4693361520767212, -0.025522174313664436, -0.027165129780769348, -1.3169987201690674, -0.2170543372631073, -0.014818832278251648, -1.4167814254760742, -0.20828677713871002, -0.00563378632068634, -0.008234242908656597, -6.913899414939806e-05, -0.0006233894382603467, -0.00027247529942542315, -0.0001358893496217206, -0.013316266238689423, -0.017450135201215744, -6.568216485902667e-05, -0.0008449559682048857, -1.9450098276138306, -0.3247310221195221, -0.02042265608906746, -0.0005900310934521258, -0.016951315104961395, -0.21214598417282104, -1.6844308376312256, -0.06588168442249298, -0.018970133736729622, -0.002135379472747445, -0.004288524389266968, -0.0219887588173151, -0.10023127496242523, -2.610649426060263e-05, -7.867782187531702e-06, -0.0002294515579706058, -0.00026603974401950836, -0.15137282013893127, -0.4819151759147644, -0.06670958548784256, -0.00682534696534276, -2.038458114839159e-05, -0.012312947772443295, -7.629365427419543e-06, -0.00023398046323563904, -8.344646857949556e-07, -0.002023079665377736, -0.20816220343112946, -0.007853937335312366, -0.09829972684383392, -0.05489731207489967, -0.045196834951639175], "finish_reason": "stop"}], "metrics": {"energy": 79.03529459953307, "energy_per_token": 1.3626774930953978, "time": 2.7450264, "time_per_token": 0.04732804137931034}}
{"outputs": [{"text": "tfidf = TfidfVectorizer()\n    return pd.DataFrame(tfidf.fit_transform(documents).toarray(), index=tfidf.get_feature_names(), columns=range(1, len(tfidf.get_feature_names()) + 1))", "tokens": ["tf", "id", "f", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "tf", "id", "f", ".", "fit", "_", "transform", "(", "doc", "uments", ")", ".", "to", "array", "()", ",", " index", "=", "tf", "id", "f", ".", "get", "_", "feature", "_", "names", "()", ",", " columns", "=", "range", "(", "1", ",", " len", "(", "tf", "id", "f", ".", "get", "_", "feature", "_", "names", "())", " +", " ", "1", "))", "\n", "\n", "def"], "logprobs": [-1.799743413925171, -0.19263486564159393, -0.002575653837993741, -0.3141855299472809, -0.011936310678720474, -8.4638240878121e-06, -0.00391799584031105, -1.1920928244535389e-07, -8.21318244561553e-05, -2.7894584491150454e-05, -0.22183473408222198, -0.3980470895767212, -0.027359435334801674, -1.6898107528686523, -0.645369291305542, -2.729855441430118e-05, -0.00666241766884923, -0.057321593165397644, -0.05182376131415367, -1.8715683836489916e-05, -3.099436753473128e-06, -0.00016485285595990717, -0.0018991068936884403, -0.003102491609752178, -0.00011681827891152352, -0.059682395309209824, -0.020835690200328827, -6.592056161025539e-05, -0.04986514896154404, -0.004484833683818579, -0.14698463678359985, -0.03806987404823303, -0.16682927310466766, -0.011445692740380764, -1.8000249862670898, -0.057589806616306305, -0.2708002030849457, -0.002152032917365432, -0.00012444675667211413, -0.0001510267611593008, -0.5398448705673218, -1.2755313036905136e-05, -0.00044800734031014144, -9.536738616588991e-07, -0.013618889264762402, -0.43535491824150085, -0.006191833410412073, -0.014543595723807812, -0.46459534764289856, -0.36015671491622925, -0.0004847066884394735, -0.8271352648735046, -0.049400169402360916, -0.38916024565696716, -0.0002004899288294837, -0.7192346453666687, -0.00015805903240107, -2.50339189733495e-06, -0.004772106651216745, -0.12634167075157166, -0.00026294111739844084, -0.00015436411194968969, -3.4570634852570947e-06, -1.4662635294371285e-05, -0.5563415288925171, -0.0016404041089117527, -0.008174060843884945, -0.0011132716899737716, -0.014925006777048111, -0.5027797818183899, -0.01868223212659359, -1.5223898887634277], "finish_reason": "stop"}], "metrics": {"energy": 83.91819892120361, "energy_per_token": 1.1655305405722725, "time": 2.961252, "time_per_token": 0.0411285}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer(tokenizer=word_tokenize)\n    tfidf = vectorizer.fit_transform(documents)\n    return pd.DataFrame(tfidf.toarray(), index=vectorizer.vocabulary_.keys(), columns=vectorizer.get_feature_names())", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "(", "token", "izer", "=", "word", "_", "token", "ize", ")", "\n", "    ", "tf", "id", "f", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "tf", "id", "f", ".", "to", "array", "()", ",", " index", "=", "vector", "izer", ".", "voc", "abulary", "_", ".", "keys", "()", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())", "\n", "\n", "#"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -1.1479090452194214, -1.0016871690750122, -0.007263443898409605, -0.030356116592884064, -0.04211030155420303, -2.0861407392658293e-05, -2.682172998902388e-05, -0.00013541258522309363, -0.20746707916259766, -0.013125448487699032, -0.023036127910017967, -1.190332293510437, -0.1650780737400055, -0.006988842040300369, -0.41491085290908813, -0.01509352307766676, -2.13382354559144e-05, -8.296622399939224e-05, -0.0010712367948144674, -0.002621549181640148, -0.000125281119835563, -0.011746407486498356, -0.011124609969556332, -3.302042750874534e-05, -0.0011951930355280638, -0.05702121555805206, -0.12461160868406296, -0.8870187401771545, -0.030683569610118866, -3.218599158572033e-05, -0.001842707279138267, -0.06457668542861938, -0.07477539777755737, -4.386805812828243e-05, -5.245195097813848e-06, -0.016571028158068657, -0.41108438372612, -0.00494969729334116, -0.017593512311577797, -0.00900434423238039, -1.4404302835464478, -0.028529109433293343, -0.352814644575119, -0.0015065044863149524, -7.164221460698172e-05, -1.4453080892562866, -0.08940505236387253, -0.04857529327273369, -0.14338894188404083, -0.004045517649501562, -0.21459798514842987, -0.0017034795600920916, -0.0066059306263923645, -0.1251719743013382, -1.7410926818847656, -0.001604342251084745, -9.97731985989958e-05, -0.3110837936401367, -2.13382354559144e-05, -0.0008738989708945155, -1.6689286894688848e-06, -0.0018255725735798478, -0.0727691650390625, -0.7445436716079712, -0.018825901672244072, -1.6775840520858765], "finish_reason": "stop"}], "metrics": {"energy": 93.2203913078308, "energy_per_token": 1.2429385507710773, "time": 3.1621115, "time_per_token": 0.042161486666666664}}
{"outputs": [{"text": "# Convert the documents to lists of words\n    words = [[word.lower() for word in word_tokenize(doc) if word.isalpha()] for doc in documents]\n\n    # Calculate the TF-IDF scores for each word\n    tf_idf = TfidfVectorizer().fit_transform(words).toarray()\n\n    # Convert the scores to a pandas dataframe\n    return pd.DataFrame(tf_idf, index=words, columns=[str(i) for i in range(len(words[0]))])", "tokens": ["#", " Convert", " the", " documents", " to", " lists", " of", " words", "\n", "    ", "words", " =", " [[", "word", ".", "lower", "()", " for", " word", " in", " word", "_", "token", "ize", "(", "doc", ")", " if", " word", ".", "is", "alpha", "()", "]", " for", " doc", " in", " documents", "]", "\n", "\n", "    ", "#", " Calculate", " the", " TF", "-", "ID", "F", " scores", " for", " each", " word", "\n", "    ", "tf", "_", "id", "f", " =", " T", "f", "id", "f", "Vector", "izer", "()", ".", "fit", "_", "transform", "(", "words", ")", ".", "to", "array", "()", "\n", "\n", "    ", "#", " Convert", " the", " scores", " to", " a", " pandas", " data", "frame", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "tf", "_", "id", "f", ",", " index", "=", "words", ",", " columns", "=[", "str", "(", "i", ")", " for", " i", " in", " range", "(", "len", "(", "words", "[", "0", "]))", "])", "\n", "\n", "if"], "logprobs": [-1.8617913722991943, -2.4147510528564453, -0.6649864912033081, -0.9673088192939758, -0.3428102135658264, -2.9085302352905273, -0.048518966883420944, -0.12860892713069916, -0.2473408728837967, -0.0015649464912712574, -1.3081189393997192, -0.3064226508140564, -2.2927894592285156, -0.07097234576940536, -0.38946473598480225, -0.020973680540919304, -0.00014840454969089478, -0.009853887371718884, -0.0008023141999728978, -0.0004542034293990582, -0.06439405679702759, -0.0002044230350293219, -0.00011336160969221964, -4.8397800128441304e-05, -0.0028046341612935066, -0.28173407912254333, -1.1757490634918213, -0.033968690782785416, -0.1771698296070099, -0.0471690334379673, -0.5130349397659302, -0.005940638016909361, -0.00014208737411536276, -0.006596101447939873, -0.031247688457369804, -0.00025102324434556067, -6.103329360485077e-05, -0.009007887914776802, -0.008554362691938877, -0.0015623279614374042, -0.11995864659547806, -0.0007876630988903344, -0.02104395255446434, -2.0935001373291016, -0.10384579002857208, -0.12511801719665527, -0.04191724210977554, -6.55629628454335e-05, -0.0002256377338198945, -0.5213338136672974, -1.2221262454986572, -0.172003835439682, -0.044274624437093735, -0.8465226292610168, -0.0007370378007180989, -1.6508173942565918, -2.5237045288085938, -0.08887368440628052, -0.00030357998912222683, -0.23262736201286316, -0.021642815321683884, -1.537788011773955e-05, -0.006388953886926174, -1.4305104514278355e-06, -0.0001546025014249608, -2.6940935640595853e-05, -0.19578416645526886, -0.07912734895944595, -0.002394429873675108, -0.026644667610526085, -4.2914423829643056e-05, -0.02598142810165882, -0.019132474437355995, -0.0005502378917299211, -0.9483340382575989, -0.12635143101215363, -0.009063294157385826, -0.0009588173124939203, -0.03342224657535553, -0.07875511795282364, -0.00040904260822571814, -0.033765409141778946, -0.8782853484153748, -0.08109966665506363, -1.358651876449585, -0.223901629447937, -0.05828234925866127, -1.3861560821533203, -2.8792479038238525, -0.046924855560064316, -0.1901732087135315, -0.0004295380203984678, -1.309356927871704, -0.00641903979703784, -0.00177107285708189, -0.0005519058904610574, -0.03940852731466293, -0.0752159059047699, -0.0005832401220686734, -1.0132738680113107e-05, -1.0728830375228426e-06, -0.06874480843544006, -1.1296665668487549, -0.06604472547769547, -0.3292534053325653, -0.317157119512558, -0.0015826807357370853, -1.6397864818572998, -2.4320836067199707, -0.008946334943175316, -0.44337698817253113, -0.07188225537538528, -0.01402592658996582, -0.0002335037279408425, -0.011618449352681637, -0.03947889059782028, -0.00033087024348787963, -0.8505541086196899, -0.00012027494085486978, -0.24571843445301056, -0.3633924126625061, -0.00044288364006206393, -0.0023847969714552164, -0.004431784152984619, -0.6336669921875, -0.020945312455296516, -1.020158052444458], "finish_reason": "stop"}], "metrics": {"energy": 133.77043177604673, "energy_per_token": 1.053310486425565, "time": 5.473128, "time_per_token": 0.04309549606299213}}
{"outputs": [{"text": "vec = TfidfVectorizer(stop_words='english')\n    tfidf = vec.fit_transform(documents)\n    words = vec.get_feature_names()\n    print(tfidf.shape)\n    df = pd.DataFrame(tfidf.todense(), index=words, columns=[\"TF-IDF\"])\n    print(df)\n    return df", "tokens": ["vec", " =", " T", "f", "id", "f", "Vector", "izer", "(", "stop", "_", "words", "='", "eng", "lish", "')", "\n", "    ", "tf", "id", "f", " =", " vec", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "words", " =", " vec", ".", "get", "_", "feature", "_", "names", "()", "\n", "    ", "print", "(", "tf", "id", "f", ".", "shape", ")", "\n", "    ", "df", " =", " pd", ".", "DataFrame", "(", "tf", "id", "f", ".", "t", "od", "ense", "()", ",", " index", "=", "words", ",", " columns", "=[", "\"", "TF", "-", "ID", "F", "\"", "])", "\n", "    ", "print", "(", "df", ")", "\n", "    ", "return", " df", "<", "|", "end", "of", "text", "|>"], "logprobs": [-3.52701735496521, -0.017376914620399475, -0.0014840076910331845, -9.059865078597795e-06, -9.762764238985255e-05, -5.483612312673358e-06, -3.707340147229843e-05, -5.125986263010418e-06, -0.9840189218521118, -1.3632489442825317, -8.332382276421413e-05, -0.0004570631426759064, -0.19222763180732727, -0.0035545756109058857, -0.00012694983161054552, -0.056551892310380936, -0.1492910534143448, -0.04257342591881752, -1.2663588523864746, -0.1931074857711792, -0.00654482189565897, -0.19031956791877747, -0.009435346350073814, -0.0001287377526750788, -0.0011479223612695932, -0.0036659911274909973, -0.00012265883560758084, -0.028290068730711937, -0.026125097647309303, -7.83174327807501e-05, -0.00125770119484514, -0.04830419272184372, -0.08503693342208862, -3.3514842987060547, -0.05867869406938553, -0.18607252836227417, -2.6225699912174605e-05, -0.030504709109663963, -6.437280717364047e-06, -0.0005311747081577778, -7.152555099310121e-07, -0.002468160120770335, -0.20560729503631592, -0.020078621804714203, -0.09292110800743103, -3.980597972869873, -0.0595068521797657, -0.8095517158508301, -0.00012683063687290996, -2.396077979938127e-05, -0.10219075530767441, -0.04807540401816368, -0.01751222088932991, -0.06092089042067528, -0.12527084350585938, -2.4271810054779053, -0.07211176306009293, -0.00978105328977108, -0.0032390295527875423, -0.005119547713547945, -0.01995464786887169, -0.18765567243099213, -6.222531374078244e-05, -1.1920858014491387e-05, -0.010132187977433205, -1.0995510816574097, -7.748303323751315e-05, -0.02126430720090866, -0.007834658026695251, -0.004445788450539112, -2.5056042671203613, -0.018117651343345642, -0.5148578882217407, -0.033111605793237686, -0.0037536416202783585, -1.6555168628692627, -0.7763932943344116, -1.6216354370117188, -0.17307232320308685, -0.003225127002224326, -0.0007820646860636771, -0.23832786083221436, -0.06933902949094772, -0.0632052943110466, -0.06391879171133041, -2.629420280456543, -0.012602335773408413, -0.1364101618528366, -0.37820830941200256, -0.010552206076681614, -0.1448436826467514, -0.05101356655359268, -0.17159304022789001, -1.62639582157135, -1.0847986231965479e-05, -1.5497195136049413e-06, -4.8397800128441304e-05, -0.00033456450910307467, -0.09601513296365738], "finish_reason": "stop"}], "metrics": {"energy": 129.81907432556153, "energy_per_token": 1.311303781066278, "time": 4.419064, "time_per_token": 0.0446370101010101}}
{"outputs": [{"text": "tfidf_vectorizer = TfidfVectorizer()\n    tf_idf = tfidf_vectorizer.fit_transform(documents)\n\n    return pd.DataFrame(tf_idf.toarray(),\n                        columns=tfidf_vectorizer.get_feature_names())", "tokens": ["tf", "id", "f", "_", "vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "tf", "_", "id", "f", " =", " tf", "id", "f", "_", "vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "tf", "_", "id", "f", ".", "to", "array", "()", ",", "\n", "                ", "        ", "columns", "=", "tf", "id", "f", "_", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())", "\n", "\n", "def"], "logprobs": [-1.799743413925171, -0.19263486564159393, -0.002575653837993741, -1.3910611867904663, -0.20645752549171448, -0.015188279561698437, -0.003082882845774293, -0.0015132891712710261, -5.364403477869928e-06, -0.001942891743965447, -3.576278118089249e-07, -1.9430925021879375e-05, -5.0424259825376794e-05, -0.33809494972229004, -0.017589999362826347, -0.034811921417713165, -0.5014036893844604, -2.766840696334839, -0.40547463297843933, -0.006339677143841982, -1.0373916625976562, -0.019766494631767273, -6.568216485902667e-05, -1.1920928244535389e-07, -0.00011681827891152352, -7.581423415103927e-05, -0.0004450284468475729, -0.00015710550360381603, -0.0018617454916238785, -0.004727852065116167, -9.357491217087954e-05, -0.01896604150533676, -0.01577833853662014, -7.593343616463244e-05, -0.000929400441236794, -0.03824910894036293, -1.9938205480575562, -0.0017357297474518418, -1.205081582069397, -0.1386970728635788, -6.711257447022945e-05, -0.003353331470862031, -0.0696253851056099, -0.18284747004508972, -0.01658087782561779, -3.3854863431770355e-05, -9.536738616588991e-07, -0.02712429128587246, -0.23609000444412231, -0.0062871999107301235, -0.02612951211631298, -0.013430599123239517, -3.032834529876709, -0.0839175283908844, -0.1924373209476471, -0.5081963539123535, -0.19869287312030792, -0.01901528425514698, -0.018494073301553726, -7.152555099310121e-07, -6.842378934379667e-05, -5.1973900554003194e-05, -7.664863369427621e-05, -9.870042413240299e-05, -0.020249076187610626, -6.198863957251888e-06, -0.00025900822947733104, -2.3841855067985307e-07, -0.0019596675410866737, -1.2162458896636963, -0.6231715679168701, -0.031076325103640556, -1.6496013402938843], "finish_reason": "stop"}], "metrics": {"energy": 91.48288247680664, "energy_per_token": 1.2531901709151594, "time": 2.9589834, "time_per_token": 0.04053401917808219}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer(stop_words='english')\n    tfidf = vectorizer.fit_transform(documents)\n    df = pd.DataFrame(tfidf.todense(), columns=vectorizer.get_feature_names(), dtype=np.float32)\n    return df", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "(", "stop", "_", "words", "='", "eng", "lish", "')", "\n", "    ", "tf", "id", "f", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "df", " =", " pd", ".", "DataFrame", "(", "tf", "id", "f", ".", "t", "od", "ense", "()", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "()", ",", " dtype", "=", "np", ".", "float", "3", "2", ")", "\n", "    ", "return", " df", "\n", "\n", "if"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -1.1479090452194214, -1.398764729499817, -7.450303382938728e-05, -0.00039569655200466514, -0.15392909944057465, -0.004081966355443001, -6.294052582234144e-05, -0.10677287727594376, -0.018769511952996254, -0.029524516314268112, -0.9396053552627563, -0.1717797815799713, -0.006607470102608204, -0.36182600259780884, -0.016102973371744156, -1.823885577323381e-05, -0.0001081169830285944, -0.0007964776013977826, -0.0024115548003464937, -9.238292841473594e-05, -0.023036593571305275, -0.023095188662409782, -6.937739817658439e-05, -0.001019673072732985, -0.07560902088880539, -0.13739775121212006, -1.7322269678115845, -0.0717741921544075, -0.015526370145380497, -0.005124173127114773, -0.005803520325571299, -0.016155054792761803, -0.11984740942716599, -4.637133679352701e-05, -6.9141146923357155e-06, -0.014705715700984001, -1.5068373680114746, -0.00011836781777674332, -0.060398295521736145, -0.018877491354942322, -0.0032309493981301785, -0.37003570795059204, -0.023124193772673607, -0.03155313432216644, -2.8013790142722428e-05, -1.883488948806189e-05, -0.00901001412421465, -6.437280717364047e-06, -0.00023827097902540118, -3.576278118089249e-07, -0.0010606384603306651, -1.7143607139587402, -0.008438171818852425, -1.6425974369049072, -0.06527110934257507, -1.2259553670883179, -5.4238757002167404e-05, -0.08051261305809021, -0.8852201700210571, -0.0003890234511345625, -0.011342448182404041, -0.03536151722073555, -0.09077757596969604, -0.0729079321026802, -0.031227238476276398, -0.5849485397338867, -0.01846037060022354, -1.1834657192230225], "finish_reason": "stop"}], "metrics": {"energy": 82.07300806999208, "energy_per_token": 1.0658832216882088, "time": 3.1625872, "time_per_token": 0.041072561038961036}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer(tokenizer=word_tokenize, stop_words=None)\n    tfidf_matrix = vectorizer.fit_transform(documents)\n    return pd.DataFrame(tfidf_matrix.toarray(), columns=vectorizer.get_feature_names())", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "(", "token", "izer", "=", "word", "_", "token", "ize", ",", " stop", "_", "words", "=", "None", ")", "\n", "    ", "tf", "id", "f", "_", "matrix", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "tf", "id", "f", "_", "matrix", ".", "to", "array", "()", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())", "<", "|", "end", "of", "text", "|>"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -1.1479090452194214, -1.0016871690750122, -0.007263443898409605, -0.030356116592884064, -0.04211030155420303, -2.0861407392658293e-05, -2.682172998902388e-05, -0.00013541258522309363, -1.679987907409668, -0.7013344764709473, -7.629365427419543e-06, -0.0005329619161784649, -1.7086198329925537, -0.9709060788154602, -0.19606463611125946, -0.01782516948878765, -0.030495228245854378, -0.9510117173194885, -0.16607774794101715, -0.009616834111511707, -0.9657489657402039, -0.167067751288414, -0.0027997603174299, -0.006019913591444492, -2.0265373677830212e-05, -3.814624506048858e-05, -0.00040058218291960657, -0.00018821375851985067, -9.107174992095679e-05, -0.012165277265012264, -0.013819841668009758, -3.802703940891661e-05, -0.0011193446116521955, -0.07605048269033432, -0.15618480741977692, -1.268215298652649, -0.028164558112621307, -2.2172682292875834e-05, -0.002097907941788435, -0.06542442739009857, -0.09076593071222305, -6.341733387671411e-05, -1.0967194612021558e-05, -0.0002047805901383981, -0.00021109737281221896, -0.007133135572075844, -0.3678480386734009, -0.017642004415392876, -0.018341930583119392, -0.008369490504264832, -0.26937341690063477, -0.026655348017811775, -0.01120878104120493, -2.7417760065873154e-05, -3.4927710657939315e-05, -0.036019258201122284, -1.1801649634435307e-05, -0.00026174934464506805, -3.576278118089249e-07, -0.0009109399979934096, -0.20091497898101807, -1.2787561416625977, -9.536738616588991e-07, -1.1920922133867862e-06, -8.535020606359467e-05, -0.00020704510097857565, -0.07356170564889908], "finish_reason": "stop"}], "metrics": {"energy": 97.74487039566041, "energy_per_token": 1.2861167157323738, "time": 3.1651192, "time_per_token": 0.04164630526315789}}
{"outputs": [{"text": "word_vec = TfidfVectorizer()\n    return pd.DataFrame(word_vec.fit_transform(documents).toarray(), columns=word_vec.get_feature_names_out())", "tokens": ["word", "_", "vec", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "word", "_", "vec", ".", "fit", "_", "transform", "(", "doc", "uments", ")", ".", "to", "array", "()", ",", " columns", "=", "word", "_", "vec", ".", "get", "_", "feature", "_", "names", "_", "out", "())", "\n", "\n", "if"], "logprobs": [-3.881517171859741, -0.055586084723472595, -3.385469436645508, -0.056597404181957245, -0.010966978035867214, -9.894321920000948e-06, -9.333651541965082e-05, -2.264974000354414e-06, -4.970903682988137e-05, -7.986990567587782e-06, -0.7255682945251465, -0.04251973330974579, -0.03388330340385437, -2.221235752105713, -0.4548782408237457, -2.4437606043647975e-05, -0.008400462567806244, -0.04288046061992645, -0.08287236094474792, -0.0006629414856433868, -0.00032693761750124395, -0.00014554394874721766, -0.0024176198057830334, -0.003758867271244526, -0.0002455409849062562, -0.05131201446056366, -0.030925968661904335, -0.00011491115583339706, -0.0814555287361145, -0.007180479355156422, -0.23013608157634735, -0.018140362575650215, -0.26419195532798767, -0.01225077360868454, -0.42138949036598206, -0.07077944278717041, -0.022432386875152588, -0.0005998004344291985, -0.0005571481888182461, -0.00033408781746402383, -0.14940831065177917, -9.894321920000948e-06, -0.0002817710628733039, -8.344646857949556e-07, -0.0065632970072329044, -2.657198667526245, -0.00012683063687290996, -0.2597823143005371, -0.5949305891990662, -0.02789471112191677, -1.2057950496673584], "finish_reason": "stop"}], "metrics": {"energy": 43.504380226135254, "energy_per_token": 0.853027063257554, "time": 1.9109023, "time_per_token": 0.03746867254901961}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer()\n    vec = vectorizer.fit_transform(documents)\n    return pd.DataFrame(vec.todense(), index=vectorizer.vocabulary_, columns=vectorizer.get_feature_names())", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "vec", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "vec", ".", "t", "od", "ense", "()", ",", " index", "=", "vector", "izer", ".", "voc", "abulary", "_", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())", "\n", "\n", "if"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -0.38277995586395264, -0.016175348311662674, -0.026147279888391495, -4.063361644744873, -0.5173878073692322, -0.005858275108039379, -3.0278701160568744e-05, -0.0006188622792251408, -0.0024738681968301535, -0.03877342864871025, -0.00031835734262131155, -0.05084816366434097, -0.020109349861741066, -3.9457496313843876e-05, -0.001359610934741795, -0.02502097189426422, -0.09820161014795303, -1.1032755374908447, -0.06061463803052902, -5.245071224635467e-05, -0.0026008610147982836, -0.058679256588220596, -0.06690003722906113, -0.005649788770824671, -1.2611355781555176, -8.940297266235575e-05, -0.019884299486875534, -0.01574278250336647, -0.005835875868797302, -1.4911798238754272, -0.01724475435912609, -0.10644315928220749, -0.0002337421028641984, -6.174850568640977e-05, -2.263062000274658, -0.12759782373905182, -0.0610855333507061, -1.291771411895752, -0.008805611170828342, -0.07614957541227341, -0.7074906826019287, -0.0026736250147223473, -0.0001110968878492713, -0.03783413767814636, -9.298280929215252e-06, -0.0009199915803037584, -1.4305104514278355e-06, -0.0021093280520290136, -0.05027391016483307, -0.5607427954673767, -0.01750144362449646, -1.22370445728302], "finish_reason": "stop"}], "metrics": {"energy": 88.85221578788756, "energy_per_token": 1.4565937014407797, "time": 2.5137277, "time_per_token": 0.04120865081967213}}
{"outputs": [{"text": "tfidf = TfidfVectorizer()\n    tfidf.fit(documents)\n    return pd.DataFrame(tfidf.transform(documents).toarray(), index=tfidf.get_feature_names())", "tokens": ["tf", "id", "f", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "tf", "id", "f", ".", "fit", "(", "doc", "uments", ")", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "tf", "id", "f", ".", "transform", "(", "doc", "uments", ")", ".", "to", "array", "()", ",", " index", "=", "tf", "id", "f", ".", "get", "_", "feature", "_", "names", "())", "\n", "\n", "if"], "logprobs": [-1.799743413925171, -0.19263486564159393, -0.002575653837993741, -0.3141855299472809, -0.011936310678720474, -8.4638240878121e-06, -0.00391799584031105, -1.1920928244535389e-07, -8.21318244561553e-05, -2.7894584491150454e-05, -0.22183473408222198, -0.3980470895767212, -0.027359435334801674, -0.9342641830444336, -0.06091460958123207, -0.004428223706781864, -0.8271743059158325, -0.010814392007887363, -0.353575736284256, -0.023465318605303764, -6.174850568640977e-05, -0.0013260389678180218, -0.014952135272324085, -0.07719207555055618, -0.9967626333236694, -0.43557387590408325, -5.9126061387360096e-05, -0.004699495155364275, -0.0731048509478569, -0.025342505425214767, -3.302042750874534e-05, -3.3378546504536644e-06, -9.643566590966657e-05, -0.078238345682621, -0.009002571925520897, -0.009520131163299084, -5.364403477869928e-06, -0.09425702691078186, -0.01489376649260521, -0.13780009746551514, -0.007186752278357744, -0.08048423379659653, -0.01653292030096054, -1.3221168518066406, -0.045875806361436844, -0.38529300689697266, -0.002100168028846383, -0.00010239553375868127, -0.0002308817347511649, -0.5950645208358765, -1.3708974620385561e-05, -0.0005422552349045873, -1.1920922133867862e-06, -0.01864970475435257, -0.8068224787712097, -0.621919572353363, -0.022311851382255554, -1.0012143850326538], "finish_reason": "stop"}], "metrics": {"energy": 70.42236454010008, "energy_per_token": 1.2141786989672427, "time": 2.3295138, "time_per_token": 0.04016403103448276}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer()\n    tfidf_matrix = vectorizer.fit_transform(documents)\n    return pd.DataFrame(tfidf_matrix.toarray(), columns=vectorizer.get_feature_names_out(), index=range(len(documents)))", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "tf", "id", "f", "_", "matrix", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "return", " pd", ".", "DataFrame", "(", "tf", "id", "f", "_", "matrix", ".", "to", "array", "()", ",", " columns", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "_", "out", "()", ",", " index", "=", "range", "(", "len", "(", "doc", "uments", ")))", "<", "|", "end", "of", "text", "|>"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -0.38277995586395264, -0.016175348311662674, -0.026147279888391495, -1.1316370964050293, -0.18103548884391785, -0.012627527117729187, -0.9017143249511719, -0.17874927818775177, -0.003420457011088729, -0.007071703672409058, -2.884823152271565e-05, -6.0437283536884934e-05, -0.00037067217635922134, -0.00041166413575410843, -8.880697714630514e-05, -0.014170265756547451, -0.022839931771159172, -4.160317621426657e-05, -0.0009507188224233687, -0.06488463282585144, -0.13554641604423523, -1.2469488382339478, -0.026011859998106956, -0.00012706902634818107, -0.0019056509481742978, -0.058594826608896255, -0.058171346783638, -4.482168878894299e-05, -1.1086402082582936e-05, -0.0002119316632160917, -0.0003064401389565319, -0.010955777019262314, -0.24359771609306335, -0.011953508481383324, -0.029799016192555428, -0.006901474203914404, -0.30491772294044495, -0.024996671825647354, -0.008584619499742985, -5.280832192511298e-05, -3.93382906622719e-05, -0.018877724185585976, -7.152531907195225e-06, -0.00025293012731708586, -3.576278118089249e-07, -0.0017983231227844954, -2.590240955352783, -0.00011514954530866817, -1.9708597660064697, -0.021152034401893616, -0.03863741084933281, -0.09510719776153564, -0.509964644908905, -0.0002411313180346042, -0.6147478818893433, -7.86750388215296e-05, -0.11012214422225952, -1.1324817933200393e-05, -0.013805967755615711, -1.8037621974945068, -1.0728830375228426e-06, -1.0728830375228426e-06, -7.807903602952138e-05, -0.0002153879904653877, -0.0974123626947403], "finish_reason": "stop"}], "metrics": {"energy": 72.09869532871247, "energy_per_token": 0.9743066936312496, "time": 2.958816, "time_per_token": 0.039984}}
{"outputs": [{"text": "tf_idf_vectorizer = TfidfVectorizer()\n    tfidf = tf_idf_vectorizer.fit_transform(documents)\n    tfidf_df = pd.DataFrame(tfidf.toarray(), columns=tf_idf_vectorizer.get_feature_names())\n    return tfidf_df", "tokens": ["tf", "_", "id", "f", "_", "vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "tf", "id", "f", " =", " tf", "_", "id", "f", "_", "vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "tf", "id", "f", "_", "df", " =", " pd", ".", "DataFrame", "(", "tf", "id", "f", ".", "to", "array", "()", ",", " columns", "=", "tf", "_", "id", "f", "_", "vector", "izer", ".", "get", "_", "feature", "_", "names", "())", "\n", "    ", "return", " tf", "id", "f", "_", "df", "<", "|", "end", "of", "text", "|>"], "logprobs": [-1.799743413925171, -2.192121744155884, -0.44383078813552856, -0.0014691284159198403, -1.1620018482208252, -0.22835996747016907, -0.021731354296207428, -0.003616461530327797, -0.0016644446877762675, -5.602820692729438e-06, -0.0025918246246874332, -9.536738616588991e-07, -2.884823152271565e-05, -8.22540732769994e-06, -0.4290214478969574, -0.02424449473619461, -0.038272857666015625, -0.4340493679046631, -1.1116013526916504, -0.011467966251075268, -1.1743431091308594, -0.011461484245955944, -0.00011431517486926168, -1.811964830267243e-05, -9.536738616588991e-07, -4.088794958079234e-05, -5.829164365422912e-05, -0.0005896736984141171, -8.797258487902582e-05, -0.0007613382767885923, -0.003346559125930071, -8.737658936297521e-05, -0.044679976999759674, -0.008954014629125595, -5.686121585313231e-05, -0.0008586533949710429, -0.040230464190244675, -0.1388987898826599, -1.8146660327911377, -0.1346580535173416, -0.003939962945878506, -0.20731236040592194, -1.532393217086792, -0.0097641721367836, -0.04858335480093956, -0.00491933012381196, -0.0032197798136621714, -0.015965716913342476, -0.08204510807991028, -0.0011887634173035622, -5.960462772236497e-07, -0.010818402282893658, -0.40214046835899353, -0.0028313808143138885, -0.022280724719166756, -0.005831846036016941, -0.3837970197200775, -0.058169882744550705, -0.004152841866016388, -0.015198964625597, -7.748573807475623e-06, -3.576278118089249e-07, -7.271740287251305e-06, -1.823885577323381e-05, -7.354942499659956e-05, -3.2782016205601394e-05, -0.017831025645136833, -3.6954811548639555e-06, -0.00021598390594590455, -2.3841855067985307e-07, -0.0010605193674564362, -0.19762080907821655, -0.018417419865727425, -0.09272479265928268, -0.05388009548187256, -0.019979069009423256, -7.986990567587782e-06, -1.1920928244535389e-07, -0.00025138078490272164, -7.235741941258311e-05, -1.4759995937347412, -2.0265558760002023e-06, -1.0728830375228426e-06, -8.976056415122002e-05, -0.00030632095877081156, -0.052865345031023026], "finish_reason": "stop"}], "metrics": {"energy": 82.66888236999512, "energy_per_token": 0.9612660740697107, "time": 3.58806, "time_per_token": 0.04172162790697675}}
{"outputs": [{"text": "documents = [word_tokenize(doc) for doc in documents]\n    vectorizer = TfidfVectorizer()\n    tfidf = vectorizer.fit_transform(documents)\n    df = pd.DataFrame(tfidf.todense(), index=vectorizer.get_feature_names(), columns=range(tfidf.shape[1]))\n    return df", "tokens": ["doc", "uments", " =", " [", "word", "_", "token", "ize", "(", "doc", ")", " for", " doc", " in", " documents", "]", "\n", "    ", "vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "tf", "id", "f", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "df", " =", " pd", ".", "DataFrame", "(", "tf", "id", "f", ".", "t", "od", "ense", "()", ",", " index", "=", "vector", "izer", ".", "get", "_", "feature", "_", "names", "()", ",", " columns", "=", "range", "(", "tf", "id", "f", ".", "shape", "[", "1", "]))", "\n", "    ", "return", " df", "\n", "\n", "if"], "logprobs": [-3.438110113143921, -0.042665500193834305, -0.15195833146572113, -0.21908707916736603, -0.6616008877754211, -0.0019957164768129587, -0.00010871296399272978, -1.0609570381348021e-05, -0.007669526617974043, -0.6574299931526184, -0.13158805668354034, -0.0018851857166737318, -0.0007316772826015949, -0.0002802217786666006, -0.017139647156000137, -0.008291228674352169, -0.024746203795075417, -0.1362728625535965, -0.4777304530143738, -0.0063570900820195675, -0.001730612595565617, -0.0006266061100177467, -2.7418097943154862e-06, -4.136476854910143e-05, -3.933898824470816e-06, -1.3828182090946939e-05, -4.410734163684538e-06, -0.30353450775146484, -0.009541739709675312, -0.01408634427934885, -0.8996201157569885, -0.16007530689239502, -0.009690623730421066, -0.5642187595367432, -0.014830812811851501, -1.3828182090946939e-05, -5.543078441405669e-05, -0.0008791395812295377, -0.0018264055252075195, -9.60780744208023e-05, -0.012146670371294022, -0.0045639872550964355, -4.708655978902243e-05, -0.0007307243067771196, -0.09277813881635666, -0.0752808079123497, -1.7560046911239624, -0.06089352071285248, -0.01907072216272354, -0.003078961046412587, -0.004335053265094757, -0.02435595542192459, -0.11178672313690186, -3.707340147229843e-05, -5.125986263010418e-06, -0.010597619228065014, -1.421926498413086, -0.00013314791431184858, -0.03734997659921646, -0.026332378387451172, -0.005461414810270071, -1.5179187059402466, -0.02348511293530464, -0.1614644080400467, -0.00023493390472140163, -3.6238969187252223e-05, -0.1325838714838028, -6.198863957251888e-06, -0.0006205302197486162, -4.768370445162873e-07, -0.0013437775196507573, -0.11061694473028183, -0.0011848341673612595, -0.010396253317594528, -0.6900320649147034, -0.16454094648361206, -0.00019047829846385866, -0.7545052766799927, -9.298280929215252e-06, -6.079655122448457e-06, -2.13382354559144e-05, -0.0037068482488393784, -0.003002304583787918, -0.013018377125263214, -0.00592890614643693, -0.01606801524758339, -0.056007396429777145, -0.040099114179611206, -0.03100421279668808, -0.7081946730613708, -0.022591719403862953, -1.1943938732147217], "finish_reason": "stop"}], "metrics": {"energy": 114.07940194702148, "energy_per_token": 1.2399934994241466, "time": 3.7998786, "time_per_token": 0.04130302826086957}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer(norm='l2')\n    tfidf = vectorizer.fit_transform(documents)\n    word_features = vectorizer.get_feature_names()\n    words_count = np.count_nonzero(tfidf.toarray(), axis=0)\n\n    return pd.DataFrame({'doc_id': range(len(documents)), 'word': word_features, 'count': words_count, 'tf_idf': tfidf.toarray().reshape(-1)})", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "(", "norm", "='", "l", "2", "')", "\n", "    ", "tf", "id", "f", " =", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")", "\n", "    ", "word", "_", "features", " =", " vector", "izer", ".", "get", "_", "feature", "_", "names", "()", "\n", "    ", "words", "_", "count", " =", " np", ".", "count", "_", "non", "zero", "(", "tf", "id", "f", ".", "to", "array", "()", ",", " axis", "=", "0", ")", "\n", "\n", "    ", "return", " pd", ".", "DataFrame", "({", "'", "doc", "_", "id", "':", " range", "(", "len", "(", "doc", "uments", "))", ",", " '", "word", "':", " word", "_", "features", ",", " '", "count", "':", " words", "_", "count", ",", " '", "tf", "_", "id", "f", "':", " tf", "id", "f", ".", "to", "array", "()", ".", "resh", "ape", "(-", "1", ")})", "\n", "\n", "def"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -1.1479090452194214, -3.7062978744506836, -0.6743106842041016, -0.03912358358502388, -0.10289708524942398, -0.4456386864185333, -0.03392363712191582, -0.027131715789437294, -1.2599735260009766, -0.18339291214942932, -0.008994420059025288, -0.43627113103866577, -0.025146296247839928, -1.9788545614574105e-05, -0.00013755806139670312, -0.0008492438937537372, -0.0038241841830313206, -9.107174992095679e-05, -0.036923374980688095, -0.01524017471820116, -6.329813186312094e-05, -0.001279726973734796, -0.09669802337884903, -0.12644262611865997, -3.0381784439086914, -0.0686621144413948, -3.128108024597168, -0.007551457732915878, -0.2878553569316864, -4.005352093372494e-05, -3.576214658096433e-05, -0.032842397689819336, -2.622600959512056e-06, -0.00036995718255639076, -4.768370445162873e-07, -0.0031225753482431173, -0.08426910638809204, -0.011487646959722042, -0.08801634609699249, -3.75711989402771, -0.6570277214050293, -2.7914793491363525, -0.0644206628203392, -3.2887487411499023, -0.0002554328821133822, -2.3014578819274902, -0.0002826052950695157, -0.00019262365822214633, -0.00015686711412854493, -0.004625692032277584, -0.04949082434177399, -0.00016044282529037446, -4.887569048150908e-06, -0.1266845315694809, -0.12207826226949692, -0.004547017626464367, -0.03893980756402016, -0.07056040316820145, -0.025612926110625267, -0.020874567329883575, -0.1352631151676178, -0.0041547417640686035, -0.09109649807214737, -1.8324300050735474, -0.00127877457998693, -1.8560965061187744, -0.042137160897254944, -6.747018051100895e-05, -0.0100624430924654, -1.6425079107284546, -0.7216579914093018, -3.5782241821289062, -0.8927802443504333, -0.7162072062492371, -0.005975122097879648, -0.8175390362739563, -0.0004127365828026086, -0.6489473581314087, -0.00010132275929208845, -0.2833313047885895, -1.6569954823353328e-05, -0.003232850693166256, -0.04736119881272316, -0.40274161100387573, -0.6317689418792725, -0.3355640172958374, -0.03429323807358742, -5.61460001335945e-05, -6.687417771900073e-05, -0.03525887429714203, -0.08551551401615143, -0.5381821990013123, -0.010194139555096626, -0.01951693370938301, -0.000527123745996505, -8.702239938429557e-06, -0.25585469603538513, -0.09277574717998505, -0.5681859254837036, -2.875603437423706, -0.15351907908916473, -0.0017113338690251112, -0.02381342649459839, -0.06465725600719452, -0.0005480932886712253, -1.1801649634435307e-05, -0.018053846433758736, -0.18200545012950897, -0.0015434031374752522, -0.1321498602628708, -0.2003016471862793, -3.1080710887908936, -2.3841830625315197e-06, -0.37814900279045105, -3.373566141817719e-05, -0.24789506196975708, -0.5634586215019226, -0.02409880980849266, -1.4036377668380737], "finish_reason": "stop"}], "metrics": {"energy": 164.7088796615601, "energy_per_token": 1.2867881223559383, "time": 5.4646115, "time_per_token": 0.04269227734375}}
{"outputs": [{"text": "vectorizer = TfidfVectorizer()\n    vectorizer.fit(documents)\n    return vectorizer.fit_transform(documents)", "tokens": ["vector", "izer", " =", " T", "f", "id", "f", "Vector", "izer", "()", "\n", "    ", "vector", "izer", ".", "fit", "(", "doc", "uments", ")", "\n", "    ", "return", " vector", "izer", ".", "fit", "_", "transform", "(", "doc", "uments", ")"], "logprobs": [-1.1385037899017334, -0.007771613076329231, -0.003941387869417667, -0.0011094611836597323, -4.291525328881107e-06, -3.2305197237292305e-05, -3.933898824470816e-06, -1.6689160474925302e-05, -5.960446742392378e-06, -0.38277995586395264, -0.016175348311662674, -0.026147279888391495, -1.6380553245544434, -0.5839328169822693, -0.023965556174516678, -0.0064575341530144215, -0.24805432558059692, -0.037872590124607086, -6.937739817658439e-05, -0.0016160060185939074, -0.03456643223762512, -0.09568651020526886, -1.4935500621795654, -1.0362334251403809, -0.0025653094053268433, -0.003882847260683775, -1.1467745304107666, -0.013793270103633404, -0.00030083899036981165, -0.02261945605278015, -0.009938754141330719, -9.059865078597795e-06, -0.04112311825156212], "finish_reason": "stop"}], "metrics": {"energy": 16.54143413543701, "energy_per_token": 0.5012555798617276, "time": 1.2806295, "time_per_token": 0.03880695454545455}}
